import lowerBounds.LbEnhanced;

import static lowerBounds.DTWLowerBound.fillEnvelope;

public class CompareWithMatlab {
    public static void main(String[] args) {
        double[] seriesA = new double[]{0, 0.0123698406598749, 0.0344387830575943, 0.0304636989601870, 0.0503745701344563,
                0.0886770397205432, 0.0909160283743023, 0.0443655196811171, 0.0354112999681930, -0.00487567095839804,
                0.0750314079848644, 0.159682929290195, 0.204012668533019, 0.257771230257126, 0.240668203065484,
                0.301160340742587, 0.395071927208631, 0.391525046001490, 0.369304597527833, 0.396802066527456,
                0.474618788528856, 0.488330919462036, 0.548154929761617, 0.524640567173441, 0.520504872778349,
                0.503664525882605, 0.439398061060247, 0.364834649825234, 0.268045010720975, 0.241969443779015,
                0.204807214966275, 0.156017041192422, 0.0762580284563598, -2.43556114574006e-16, -0.0696815644070169,
                -0.135035160429626, -0.226793770294537, -0.310430501900497, -0.387658462186557, -0.470456632679655,
                -0.482751268461515, -0.575296717931732, -0.614087185788883, -0.742815229628577, -0.762136609623704,
                -0.824638326843309, -0.826679683306134, -0.904643856254333, -0.982363504254368, -0.913691095623352,
                -0.906572569232632, -0.892387308741729, -0.951466928902952, -0.994258390285043, -0.972346741559184,
                -0.941450419206638, -0.946546845369850, -0.892721401584111, -0.756801315625827, -0.725541806983436,
                -0.607687245045754, -0.478450009108767, -0.383380851114914, -0.284454515773644, -0.207902778450304,
                -0.0992012479845515, 6.30504096226964e-16, 0.0891266544519014, 0.194249770693692, 0.279308011789929,
                0.360545906910347, 0.429367059876963, 0.530692199382963, 0.602137183260898, 0.729499906352010,
                0.831675184041366, 0.861146009349223, 0.884721821200597, 1.02009801412932, 1.06160667713002,
                1.06296029532000, 1.05443152839638, 1.07774029148177, 1.14980744411571, 1.18509085903580,
                1.07741248846014, 1.06626405189911, 1.06167706112374, 0.991409668290598, 0.862580040652889,
                0.762172798095054, 0.719600554783975, 0.672368661748165, 0.572111686438953, 0.526829282759205,
                0.464345688043230, 0.366486543144191, 0.252696446034523, 0.119178673905792, 4.95727671834285e-16};
        double[] seriesB = new double[]{0.870732306177376, 0.805892178944290, 0.776495267482669, 0.743563695303364,
                0.691956083856449, 0.686117617930272, 0.637259897414634, 0.610255278983612, 0.618289768656612,
                0.525694667906707, 0.419095916012481, 0.337779717943564, 0.303338155163618, 0.235996712110778,
                0.185006902493771, 0.123233173852004, 0.0416503368037618, -0.0454385363965071, -0.132427489245307,
                -0.231012241731358, -0.324135984719623, -0.395763665046309, -0.475728859992399, -0.502595945563724,
                -0.568745797348098, -0.686562339697567, -0.690425648228589, -0.819135169172724, -0.858111956834873,
                -0.985880092783652, -1.08624682316067, -1.10349106468369, -1.03804642904448, -1.06919200148360,
                -0.983938641659001, -1.05011658607171, -0.933532113119432, -0.964467403929744, -0.965424346394401,
                -0.867958667837341, -0.778097486824114, -0.773512506179215, -0.748923382735313, -0.638685526114802,
                -0.526639886624991, -0.425007428977792, -0.354288285838143, -0.270524003090758, -0.171910726598958,
                -0.0589484619071733, 0.0588873283097105, 0.171171411021053, 0.287327389977099, 0.377557381409117,
                0.520592520436279, 0.580076199068418, 0.681242024071908, 0.742436623494366, 0.767018406078834,
                0.908641028358650, 0.909966013643827, 0.940487738185380, 0.904191417325548, 0.989712695857539,
                1.03888721780033, 1.13342067818926, 1.16439487798295, 1.25767965833201, 1.28699265600121,
                1.27461850777136, 1.26775113849411, 1.17496594743562, 1.10975080204005, 0.969049997188914,
                0.865785743054154, 0.846350474752057, 0.769907029857295, 0.662345977459138, 0.514608695979324,
                0.387980180147027, 0.256783119183052, 0.168763948676547, 0.0585245816941639, -0.0621739867977549,
                -0.184572952374006, -0.288107435993194, -0.421190637799266, -0.570021046941876, -0.653444743958769,
                -0.713751918815663, -0.837583701209564, -0.921229684715531, -0.986965574168200, -0.988238334118086,
                -0.964276618191506, -0.936902663254102, -1.04826664046834, -1.01432539448768, -1.07246510015503,
                -1.14295836363333};

        double[] uB = new double[seriesB.length];
        double[] lB = new double[seriesB.length];

        // for w = 10 and v = 5
        int w = 10; // warping window size
        int v = 5; // LbEnhanced parameter
        fillEnvelope(seriesB, w, uB, lB);
        LbEnhanced lbComputer = new LbEnhanced();

        double lbDistanceFromMatlab = 19.479615005859369;
        double distance = lbComputer.distance(seriesA, seriesB, uB, lB, w, v, Double.POSITIVE_INFINITY);
        System.out.println("For v=" + v + ", w=" + w);
        System.out.println("Distance in Java:" + distance);
        System.out.println("Distance in Matlab:" + lbDistanceFromMatlab);

        // for w = 10 and v = 10
        w = 10; // warping window size
        v = 10; // LbEnhanced parameter
        fillEnvelope(seriesB, w, uB, lB);
        lbComputer = new LbEnhanced();

        lbDistanceFromMatlab = 23.457416862054789;
        distance = lbComputer.distance(seriesA, seriesB, uB, lB, w, v, Double.POSITIVE_INFINITY);
        System.out.println("For v=" + v + ", w=" + w);
        System.out.println("Distance in Java:" + distance);
        System.out.println("Distance in Matlab:" + lbDistanceFromMatlab);

        // for w = 5 and v = 5
        w = 5; // warping window size
        v = 5; // LbEnhanced parameter
        fillEnvelope(seriesB, w, uB, lB);
        lbComputer = new LbEnhanced();

        lbDistanceFromMatlab = 50.877861721037796;
        distance = lbComputer.distance(seriesA, seriesB, uB, lB, w, v, Double.POSITIVE_INFINITY);
        System.out.println("For v=" + v + ", w=" + w);
        System.out.println("Distance in Java:" + distance);
        System.out.println("Distance in Matlab:" + lbDistanceFromMatlab);

        // for w = 20 and v = 5
        w = 20; // warping window size
        v = 5; // LbEnhanced parameter
        fillEnvelope(seriesB, w, uB, lB);
        lbComputer = new LbEnhanced();

        lbDistanceFromMatlab = 8.315026024255936;
        distance = lbComputer.distance(seriesA, seriesB, uB, lB, w, v, Double.POSITIVE_INFINITY);
        System.out.println("For v=" + v + ", w=" + w);
        System.out.println("Distance in Java:" + distance);
        System.out.println("Distance in Matlab:" + lbDistanceFromMatlab);
    }
}
